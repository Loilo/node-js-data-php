function isPlainObject(e){return"object"==typeof e&&null!==e&&null==e.prototype&&e.constructor===Object}function entries(e){return Object.entries?Object.entries(e):Object.keys(e).map(t=>[t,e[t]])}function extend(...e){if(Object.assign)return Object.assign(...e);if(0===e.length)throw new TypeError("Cannot convert undefined or null to object");if(1===e.length)return e[0];for(let t in e[1])e[0][t]=e[1][t];return extend(e[0],...e.slice(2))}function has(e,t){return e.includes?e.includes(t):-1!==e.indexOf(t)}function isInteger(e){return Number.isInteger?Number.isInteger(e):"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}function isNonNegativeInteger(e){return isInteger(e)&&e>=0}function escapeRegex(e){return e.replace(/[-[\]\/{}()*+?.\\^$|]/g,"\\$&")}function startsWith(e,t){return e.startsWith?e.startsWith(t):e.slice(0,t.length)===t}function internalConvert(e,t={},{refs:n=[],trail:r=[]}={}){const{castToObject:i=!1,bracketArrays:l=!0,indentation:o=2,trailingCommas:s=!1,startingIndentationLevel:a=0,quotes:c="single",removeUndefinedProperties:u=!0,onCircular:g="nullWithComment",onNaN:f="nullWithComment"}=t;if("tab"!==o&&!isNonNegativeInteger(o))throw new Error('`indentation` must be non-negative integer or "tab"');if(!has(["single","double"],c))throw new Error('`quotes` must be either "single" or "double"');const h=["null","nullWithComment","string","throw"];if(!has(h,g))throw new Error('`onCircular` must be either "null", "nullWithComment", "string" or "throw"');if(!has(h,f))throw new Error('`onNaN` must be either "null", "nullWithComment", "string" or "throw"');function m(e,t){return t||(t="single"===c?"'":'"'),t+e.replace(/\\/g,"\\\\").replace(new RegExp(escapeRegex(t),"g"),"\\"+t)+t}function p(e=1){return("tab"===o?"\t":" ".repeat(o)).repeat(a+e)}function N(){return r.length?"":p(0)}function w(){switch(g){case"null":return"null";case"nullWithComment":return"null /* CIRCULAR */";case"string":return m("::CIRCULAR::");case"throw":b(new Error("err:circular:"+JSON.stringify(r)))}}function b(e){let t;throw startsWith(e.message,"err:type:")?(t=JSON.parse(e.message.slice(9)).slice(0,-1)).length?new Error(`Disallowed value type in ${y(t)}`):new Error("Disallowed input type"):startsWith(e.message,"err:plain:")?(t=JSON.parse(e.message.slice(10)).slice(0,-1)).length?new Error(`Disallowed non-plain object in ${y(t)}`):new Error("Disallowed non-plain object input"):startsWith(e.message,"err:circular:")?(t=JSON.parse(e.message.slice(13)),new Error(`Circular reference: ${y(t)}`)):startsWith(e.message,"err:NaN:")?(t=JSON.parse(e.message.slice(8))).length?new Error(`Invalid NaN: ${y(t)}`):new Error("Invalid NaN input"):e}function y(e){return"INPUT"+e.map((e,t)=>"number"==typeof e?"["+String(e)+"]":e.match(/^[a-z0-9_$]+$/i)?`.${e}`:`[${m(e,'"')}]`).join("")}let d="";if(Array.isArray(e))if(has(n,e))try{d+=w()}catch(e){return b(e)}else d+=function(e){let i="";i+=N(),i+=l?"[":"array(",e.length&&(i+="\n");for(let l=0;l<e.length;l++){let o;try{o=internalConvert(e[l],extend({},t,{startingIndentationLevel:a+1}),{refs:n.concat([e]),trail:r.concat(l)}),i+=p()+o,(s||l+1<e.length)&&(i+=","),i+="\n"}catch(e){b(e)}}return e.length&&(i+=p(0)),i+=l?"]":")"}(e);else if(null==e)d+=N(),d+="null";else if("object"==typeof e)if(isPlainObject(e))if(has(n,e))try{d+=w()}catch(e){b(e)}else d+=function(e){let o="";o+=N(),i&&(o+="(object) "),o+=l?"[":"array(";let c=entries(e);u&&(c=c.filter(([e,t])=>void 0!==t)),c.length&&(o+="\n");let g=1;for(const[i,l]of c){let u;try{u=internalConvert(l,extend({},t,{startingIndentationLevel:a+1}),{refs:n.concat(e),trail:r.concat(i)})}catch(e){b(e)}o+=p()+m(i)+" => "+u,(s||g!==c.length)&&(o+=","),o+="\n",g++}return c.length&&(o+=p(0)),o+=l?"]":")"}(e);else b(new Error("err:plain:"+JSON.stringify(r)));else"number"==typeof e?(d+=N(),isNaN(e)?d+=function(){switch(f){case"null":return"null";case"nullWithComment":return"null /* NaN */";case"string":return m("::NaN::");case"throw":b(new Error("err:NaN:"+JSON.stringify(r)))}}():d+=e===1/0?"INF":e===-1/0?"-INF":String(e)):"boolean"==typeof e?(d+=N(),d+=String(e)):"string"==typeof e?(d+=N(),d+=m(e)):b(new Error("err:type:"+JSON.stringify(r)));return d}function convert(e,t){return internalConvert(e,t)}export default convert;
